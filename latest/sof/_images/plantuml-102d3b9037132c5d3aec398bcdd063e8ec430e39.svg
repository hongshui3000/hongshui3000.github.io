<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="480px" preserveAspectRatio="none" style="width:600px;height:480px;" version="1.1" viewBox="0 0 600 480" width="600px" zoomAndPan="magnify"><defs><filter height="300%" id="f18gqjp8o5ot6c" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" height="458.5386" style="stroke: #A1A1CA; stroke-width: 1.0;" width="64" x="29" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="47.5" y="18.8979">Host</text><rect fill="#DDDDDD" height="458.5386" style="stroke: #A1A1CA; stroke-width: 1.0;" width="147" x="189" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57" x="234" y="18.8979">HD/A HW</text><rect fill="#FFFFFF" height="458.5386" style="stroke: #A1A1CA; stroke-width: 1.0;" width="158" x="338" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="403.5" y="18.8979">DSP</text><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="61" x2="61" y1="82.9946" y2="468.5386"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="226" x2="226" y1="82.9946" y2="468.5386"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="300" x2="300" y1="82.9946" y2="468.5386"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="364" x2="364" y1="82.9946" y2="468.5386"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="453" x2="453" y1="82.9946" y2="468.5386"/><rect fill="#FFFFFF" filter="url(#f18gqjp8o5ot6c)" height="52.2402" style="stroke: #33335B; stroke-width: 1.5;" width="52" x="33" y="25.7544"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="45" y="48.7983">Host</text><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="40" y="67.9185">Driver</text><rect fill="#FFFFFF" filter="url(#f18gqjp8o5ot6c)" height="33.1201" style="stroke: #33335B; stroke-width: 1.5;" width="62" x="193" y="44.8745"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="200" y="67.9185">hda_sw</text><rect fill="#FFFFFF" filter="url(#f18gqjp8o5ot6c)" height="33.1201" style="stroke: #33335B; stroke-width: 1.5;" width="59" x="269" y="44.8745"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="276" y="67.9185">hda_fw</text><rect fill="#FFFFFF" filter="url(#f18gqjp8o5ot6c)" height="33.1201" style="stroke: #33335B; stroke-width: 1.5;" width="41" x="342" y="44.8745"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="349" y="67.9185">host</text><rect fill="#FFFFFF" filter="url(#f18gqjp8o5ot6c)" height="33.1201" style="stroke: #33335B; stroke-width: 1.5;" width="73" x="415" y="44.8745"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="422" y="67.9185">hda_dma</text><path d="M176,97.9946 L176,124.9946 L345,124.9946 L345,107.9946 L335,97.9946 L176,97.9946 " fill="#F6ED80" filter="url(#f18gqjp8o5ot6c)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M335,97.9946 L335,107.9946 L345,107.9946 L335,97.9946 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="182" y="117.8926">"DMA in RUNNING state"</text><polygon fill="#4A4A86" points="49,154.5034,59,158.5034,49,162.5034,53,158.5034" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="3" x2="55" y1="158.5034" y2="158.5034"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="10" y="153.647">Stop?</text><polygon fill="#4A4A86" points="352.5,191.2578,362.5,195.2578,352.5,199.2578,356.5,195.2578" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="61" x2="358.5" y1="195.2578" y2="195.2578"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="68" y="190.4014">COMP_TRIGGER_PAUSE ?</text><path d="M369,171.5034 L369,198.5034 L588,198.5034 L588,181.5034 L578,171.5034 L369,171.5034 " fill="#F6ED80" filter="url(#f18gqjp8o5ot6c)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M578,171.5034 L578,181.5034 L588,181.5034 L578,171.5034 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="198" x="375" y="191.4014">No more FPI touching at this point</text><polygon fill="#4A4A86" points="72,210.2578,62,214.2578,72,218.2578,68,214.2578" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="66" x2="363.5" y1="214.2578" y2="214.2578"/><polygon fill="#4A4A86" points="214,242.0122,224,246.0122,214,250.0122,218,246.0122" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="61" x2="220" y1="246.0122" y2="246.0122"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="68" y="241.1558">RUN := 0</text><polygon fill="#4A4A86" points="352.5,273.7666,362.5,277.7666,352.5,281.7666,356.5,277.7666" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="61" x2="358.5" y1="277.7666" y2="277.7666"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="68" y="272.9102">COMP_TRIGGER_STOP</text><polygon fill="#4A4A86" points="441.5,305.521,451.5,309.521,441.5,313.521,445.5,309.521" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="364.5" x2="447.5" y1="309.521" y2="309.521"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="371.5" y="304.6646">dma_stop()</text><polygon fill="#4A4A86" points="311.5,337.2754,301.5,341.2754,311.5,345.2754,307.5,341.2754" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="305.5" x2="452.5" y1="341.2754" y2="341.2754"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="317.5" y="336.4189">GEN := 0</text><polygon fill="#4A4A86" points="311.5,369.0298,301.5,373.0298,311.5,377.0298,307.5,373.0298" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="305.5" x2="452.5" y1="373.0298" y2="373.0298"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="317.5" y="368.1733">FIFORDY := 0</text><polygon fill="#4A4A86" points="375.5,383.0298,365.5,387.0298,375.5,391.0298,371.5,387.0298" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="369.5" x2="452.5" y1="387.0298" y2="387.0298"/><polygon fill="#4A4A86" points="72,397.0298,62,401.0298,72,405.0298,68,401.0298" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="66" x2="363.5" y1="401.0298" y2="401.0298"/><polygon fill="#4A4A86" points="214,446.5386,224,450.5386,214,454.5386,218,450.5386" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="61" x2="220" y1="450.5386" y2="450.5386"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="68" y="427.9277">Flush DMA,</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="68" y="445.6821">set SRST (stream reset)</text><!--MD5=[227ba4003f7cd9628bb9f664e3efe689]
@startuml
hidefootbox
skinparam componentStyle uml2

skinparam defaultFontColor	#33335b

skinparam rectangle {
	color		#d6d6de
	backgroundColor	#ffffff
}

skinparam component {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}

skinparam interface {
	backgroundColor	#ffffff
	borderColor	#f05772
}

skinparam class {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}
skinparam stereotypeCBackgroundColor	#6fccdd

skinparam sequence {
	arrowColor		#4a4a86
	lifeLineBorderColor	#f05772
	groupBorderColor	#a1a1ca
	boxBorderColor		#a1a1ca
	dividerBorderColor	#d6d6de
	dividerBorderThickness	1
}
skinparam participant {
	borderColor		#33335b
	backgroundColor		#ffffff
}
skinparam actor {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam state {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam node {
	backgroundColor		#ffffff
}

skinparam note {
	backgroundColor 	#f6ed80
	borderColor		#d6d6de
}
box "Host" #ffffff
    participant "Host\nDriver" as drv
end box
box "HD/A HW"
	participant hda_sw
	participant hda_fw
end box
box "DSP" #ffffff
    participant host
    participant hda_dma
end box

note over hda_sw, hda_fw: "DMA in RUNNING state"

-> drv : Stop?

    drv -> host : COMP_TRIGGER_PAUSE ?
            note right : No more FPI touching at this point
        drv <- - host

    drv -> hda_sw : RUN := 0

    drv -> host : COMP_TRIGGER_STOP
        host -> hda_dma : dma_stop()
            hda_fw <- hda_dma : GEN := 0
            hda_fw <- hda_dma : FIFORDY := 0
            host <- - hda_dma
        drv <- - host

    drv -> hda_sw : Flush DMA,\nset SRST (stream reset)

@enduml

PlantUML version 1.2019.12(Sun Nov 03 18:24:54 CST 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_321-b07
Operating System: Windows 10
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg>