<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="528px" preserveAspectRatio="none" style="width:719px;height:528px;" version="1.1" viewBox="0 0 719 528" width="719px" zoomAndPan="magnify"><defs><filter height="300%" id="f1lmeo82oajdae" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="58.7544" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="41" y="407.7896"/><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="64.7544" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="299" y="146.9946"/><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="211.772" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="299" y="286.5264"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="46" x2="46" y1="108.2402" y2="219.749"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="46" x2="46" y1="219.749" y2="262.772"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="46" x2="46" y1="262.772" y2="516.2983"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="303.5" x2="303.5" y1="108.2402" y2="219.749"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="303.5" x2="303.5" y1="219.749" y2="262.772"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="303.5" x2="303.5" y1="262.772" y2="516.2983"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="664.5" x2="664.5" y1="108.2402" y2="219.749"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="664.5" x2="664.5" y1="219.749" y2="262.772"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="664.5" x2="664.5" y1="262.772" y2="516.2983"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="19" x="33.5" y="86.0439">dai</text><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="8" y="105.1641">component</text><ellipse cx="46" cy="13" fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" rx="8" ry="8" style="stroke: #33335B; stroke-width: 2.0;"/><path d="M46,21 L46,48 M33,29 L59,29 M46,48 L33,63 M46,48 L59,63 " fill="none" filter="url(#f1lmeo82oajdae)" style="stroke: #33335B; stroke-width: 2.0;"/><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="33.1201" style="stroke: #33335B; stroke-width: 1.5;" width="73" x="265.5" y="70.1201"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="272.5" y="93.1641">hda_dma</text><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="33.1201" style="stroke: #33335B; stroke-width: 1.5;" width="91" x="617.5" y="70.1201"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="624.5" y="93.1641">work_queue</text><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="58.7544" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="41" y="407.7896"/><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="64.7544" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="299" y="146.9946"/><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="211.772" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="299" y="286.5264"/><polygon fill="#4A4A86" points="287,142.9946,297,146.9946,287,150.9946,291,146.9946" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="46" x2="293" y1="146.9946" y2="146.9946"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="53" y="142.1382">dma_start()</text><path d="M314,123.2402 L314,150.2402 L490,150.2402 L490,133.2402 L480,123.2402 L314,123.2402 " fill="#F6ED80" filter="url(#f1lmeo82oajdae)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M480,123.2402 L480,133.2402 L490,133.2402 L480,123.2402 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="320" y="143.1382">GEN := 1 -&gt; transfer starts</text><polygon fill="#4A4A86" points="653,179.749,663,183.749,653,187.749,657,183.749" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="309" x2="659" y1="183.749" y2="183.749"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="332" x="316" y="178.8926">work_schedule_default(&amp;hda_work, HDA_LINK_1MS_US)</text><polygon fill="#4A4A86" points="320,193.749,310,197.749,320,201.749,316,197.749" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="314" x2="664" y1="197.749" y2="197.749"/><polygon fill="#4A4A86" points="57,207.749,47,211.749,57,215.749,53,211.749" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="51" x2="303" y1="211.749" y2="211.749"/><text fill="#33335B" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="323.5" y="246.355">1 ms elapsed</text><polygon fill="#4A4A86" points="320,282.5264,310,286.5264,320,290.5264,316,286.5264" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="314" x2="664" y1="286.5264" y2="286.5264"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="326" y="281.6699">hda_work-&gt;cb()</text><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="309" x2="351" y1="318.2808" y2="318.2808"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="351" x2="351" y1="318.2808" y2="331.2808"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="310" x2="351" y1="331.2808" y2="331.2808"/><polygon fill="#4A4A86" points="320,327.2808,310,331.2808,320,335.2808,316,331.2808" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="316" y="313.4243">update FPI by 'bytes'</text><path d="M449,301.0264 L449,328.0264 L693,328.0264 L693,311.0264 L683,301.0264 L449,301.0264 " fill="#F6ED80" filter="url(#f1lmeo82oajdae)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M683,301.0264 L683,311.0264 L693,311.0264 L683,301.0264 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="455" y="320.9243">'commit' is always true in this scenario</text><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="309" x2="351" y1="363.0352" y2="363.0352"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="351" x2="351" y1="363.0352" y2="376.0352"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="310" x2="351" y1="376.0352" y2="376.0352"/><polygon fill="#4A4A86" points="320,372.0352,310,376.0352,320,380.0352,316,376.0352" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="316" y="358.1787">wait for next period to be available (w/ short t/o)</text><polygon fill="#4A4A86" points="62,403.7896,52,407.7896,62,411.7896,58,407.7896" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="56" x2="298" y1="407.7896" y2="407.7896"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="68" y="402.9331">callback()</text><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="51" x2="93" y1="439.5439" y2="439.5439"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="93" x2="93" y1="439.5439" y2="452.5439"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="52" x2="93" y1="452.5439" y2="452.5439"/><polygon fill="#4A4A86" points="62,448.5439,52,452.5439,62,456.5439,58,452.5439" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="58" y="434.6875">comp_update_buffer_produce/consume()</text><polygon fill="#4A4A86" points="287,462.5439,297,466.5439,287,470.5439,291,466.5439" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="46" x2="293" y1="466.5439" y2="466.5439"/><polygon fill="#4A4A86" points="653,494.2983,663,498.2983,653,502.2983,657,498.2983" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="304" x2="659" y1="498.2983" y2="498.2983"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="209" x="311" y="493.4419">1MS_TIMEOUT (to re-arm the timer)</text><!--MD5=[e96d9c1fe3b93a87f425f38a19f9229d]
@startuml
hidefootbox
skinparam componentStyle uml2

skinparam defaultFontColor	#33335b

skinparam rectangle {
	color		#d6d6de
	backgroundColor	#ffffff
}

skinparam component {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}

skinparam interface {
	backgroundColor	#ffffff
	borderColor	#f05772
}

skinparam class {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}
skinparam stereotypeCBackgroundColor	#6fccdd

skinparam sequence {
	arrowColor		#4a4a86
	lifeLineBorderColor	#f05772
	groupBorderColor	#a1a1ca
	boxBorderColor		#a1a1ca
	dividerBorderColor	#d6d6de
	dividerBorderThickness	1
}
skinparam participant {
	borderColor		#33335b
	backgroundColor		#ffffff
}
skinparam actor {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam state {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam node {
	backgroundColor		#ffffff
}

skinparam note {
	backgroundColor 	#f6ed80
	borderColor		#d6d6de
}
actor client as "dai\ncomponent"
participant hda_dma
participant work_queue

client -> hda_dma : dma_start()
	activate hda_dma
	note right: GEN := 1 -> transfer starts

	hda_dma -> work_queue : work_schedule_default(&hda_work, HDA_LINK_1MS_US)
	hda_dma <- - work_queue
client <- - hda_dma
deactivate hda_dma

... 1 ms elapsed ...

work_queue -> hda_dma : hda_work->cb()
	activate hda_dma

   hda_dma -> hda_dma : update FPI by 'bytes'
   note right: 'commit' is always true in this scenario

	hda_dma -> hda_dma : wait for next period to be available (w/ short t/o)

	hda_dma -> client : callback()
		activate client
		client -> client : comp_update_buffer_produce/consume()
	hda_dma <- - client
	deactivate client

work_queue <- - hda_dma : 1MS_TIMEOUT (to re-arm the timer)
deactivate hda_dma

@enduml

PlantUML version 1.2019.12(Sun Nov 03 18:24:54 CST 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_321-b07
Operating System: Windows 10
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg>