

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Suggestions before filing an SOF bug &mdash; SOF Project 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/zc.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/zc.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/common.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/sof.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
  <script type="text/javascript" src="../../_static/js/zcaniot.js"></script>

    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Supported Architectures" href="../../architectures/index.html" />
    <link rel="prev" title="Overview of Intel hardware platforms" href="introduction.html" />
  <link rel="shortcut icon" href="../../_static/images/favicon.ico"/>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> SOF Project
          

          
            
            <img src="../../_static/logo_sof_white_200w.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference external" href="https://sofproject.org">SOF project website</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction to the SOF Project</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Getting Started Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#build-sof">Build SOF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#set-up-sof-on-hardware">Set up SOF on hardware</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#debug-audio-issues-on-intel-platforms">Debug Audio issues on Intel platforms</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html">Overview of Intel hardware platforms</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Suggestions before filing an SOF bug</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#run-alsa-info">Run alsa-info</a></li>
<li class="toctree-l4"><a class="reference internal" href="#disable-sof-on-pci-hdaudio-devices-to-test-audio-playback">Disable SOF on PCI/HDaudio devices to test audio playback</a></li>
<li class="toctree-l4"><a class="reference internal" href="#try-booting-into-windows-first-then-reboot-into-linux">Try booting into Windows first, then reboot into Linux</a></li>
<li class="toctree-l4"><a class="reference internal" href="#make-sure-the-me-is-enabled">Make sure the ME is enabled</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-at-the-alsa-hw-device-level">Test at the ALSA ‘hw’ device level</a></li>
<li class="toctree-l4"><a class="reference internal" href="#verify-mixer-settings">Verify mixer settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#enable-dynamic-debug">Enable dynamic debug</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-sof-logger">Install sof-logger</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../architectures/index.html">Supported Architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platforms/index.html">Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../algos/index.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer_guides/index.html">Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release.html">Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contributing to the Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tsc/index.html">Technical Steering Committee (TSC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainers/index.html">SOF admin, maintainers and code owners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentations/index.html">Presentations</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SOF Project</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Getting Started Guides</a> &raquo;</li>
        
      <li>Suggestions before filing an SOF bug</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/getting_started/intel_debug/suggestions.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="suggestions-before-filing-an-sof-bug">
<span id="debug-suggestions"></span><h1>Suggestions before filing an SOF bug<a class="headerlink" href="#suggestions-before-filing-an-sof-bug" title="Permalink to this headline">¶</a></h1>
<div class="section" id="run-alsa-info">
<h2>Run alsa-info<a class="headerlink" href="#run-alsa-info" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">alsa-info</span></code> script extracts a lot of information from the platform
(PCI ids, ACPI ids, DMI, controls, dmesg) that will help the SOF team
understand which hardware and OEM configuration is used. <code class="docutils literal notranslate"><span class="pre">alsa-info</span></code>
can upload the results to a server; providing the link is very useful
when filing a bug.</p>
</div>
<div class="section" id="disable-sof-on-pci-hdaudio-devices-to-test-audio-playback">
<h2>Disable SOF on PCI/HDaudio devices to test audio playback<a class="headerlink" href="#disable-sof-on-pci-hdaudio-devices-to-test-audio-playback" title="Permalink to this headline">¶</a></h2>
<p>When audio issues occur, first see if the HDaudio legacy can generate sound
on speakers and headsets. Accomplish this by adding “options
snd-intel-dspcfg dsp_driver=1” to <code class="docutils literal notranslate"><span class="pre">/etc/modprobe.d/alsa-base.conf</span></code>.</p>
<p>If no sound can be heard and jack detection is not functional, an
HDaudio external codec configuration is likely. In some cases, the
Linux drivers are missing configuration information and may only
enable two of the four speakers present. All of these cases are orthogonal
to SOF issues in that the SOF driver cannot compensate for codec driver
problems on its own.</p>
</div>
<div class="section" id="try-booting-into-windows-first-then-reboot-into-linux">
<h2>Try booting into Windows first, then reboot into Linux<a class="headerlink" href="#try-booting-into-windows-first-then-reboot-into-linux" title="Permalink to this headline">¶</a></h2>
<p>On some platforms, such as with an HDaudio codec connected to amplifiers
over an I2C/I2S link, the codec driver needs to perform a set of
amplifier configurations. This is often handled in Windows but not in
Linux codec drivers. A classic example of such issues is when
headphone playback works, but speaker playback does not (or not on all
speakers).</p>
<p>These types of issues also occur with the HDaudio legacy driver
and are not part of SOF bugs proper. To fix such issues, either obtain
direct support from the codec vendor, or reverse-engineer the missing
configuration by snooping HDaudio commands in a Windows environment.</p>
</div>
<div class="section" id="make-sure-the-me-is-enabled">
<h2>Make sure the ME is enabled<a class="headerlink" href="#make-sure-the-me-is-enabled" title="Permalink to this headline">¶</a></h2>
<p>If the ME is disabled by the OEM or the user, firmware authentication
will fail without any explicit feedback provided to the user. In case
of any authentication failure, verify that the ME is not disabled. More
information about the ME is available in the “Firmware binary” section of <a class="reference internal" href="introduction.html#intel-debug-introduction"><span class="std std-ref">Overview of Intel hardware platforms</span></a>.</p>
</div>
<div class="section" id="test-at-the-alsa-hw-device-level">
<h2>Test at the ALSA ‘hw’ device level<a class="headerlink" href="#test-at-the-alsa-hw-device-level" title="Permalink to this headline">¶</a></h2>
<p>When the legacy HDaudio driver produces audible sound without
distortion and an SOF-based solution does not, user space configuration
issues are possible.</p>
<p>Use the following commands to check if the SOF driver is functional at the hardware device level:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">speaker</span><span class="o">-</span><span class="n">test</span> <span class="o">-</span><span class="n">Dhw</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span> <span class="o">-</span><span class="n">c2</span> <span class="o">-</span><span class="n">r48000</span> <span class="o">-</span><span class="n">f</span> <span class="n">S16_LE</span>
<span class="n">arecord</span> <span class="o">-</span><span class="n">Dhw</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span> <span class="o">-</span><span class="n">c2</span> <span class="o">-</span><span class="n">r48000</span> <span class="o">-</span><span class="n">f</span> <span class="n">S16_LE</span> <span class="o">-</span><span class="n">d</span> <span class="mi">10</span> <span class="n">test</span><span class="o">.</span><span class="n">wav</span>
</pre></div>
</div>
<p>The card and device indices may need to be adjusted on different
platforms: use <code class="docutils literal notranslate"><span class="pre">aplay</span> <span class="pre">-l</span></code> and <code class="docutils literal notranslate"><span class="pre">arecord</span> <span class="pre">-l</span></code> to see supported values on
your platform.</p>
<p>If the playback or capture seems ok at the hardware device level, then the
following packages may need to be updated:</p>
<ul class="simple">
<li><p>alsa-lib</p></li>
<li><p>alsa-ucm-conf</p></li>
<li><p>pulseaudio</p></li>
</ul>
</div>
<div class="section" id="verify-mixer-settings">
<h2>Verify mixer settings<a class="headerlink" href="#verify-mixer-settings" title="Permalink to this headline">¶</a></h2>
<p>A classic issue with Linux audio is that a mixer control value remains
muted or with a volume set to zero. The <code class="docutils literal notranslate"><span class="pre">alsamixer</span></code> command can be
used to check if any paths are disabled (represented as “m”) or if the
volume settings are not correct.</p>
<p>Note that randomly playing with ALSA mixer settings can damage audio
accessories, speakers, or your hearing. Never change mixer
settings while listening to loud music on a headset!</p>
</div>
<div class="section" id="enable-dynamic-debug">
<h2>Enable dynamic debug<a class="headerlink" href="#enable-dynamic-debug" title="Permalink to this headline">¶</a></h2>
<p>To avoid spamming all Linux users with audio-specific information,
only critical errors are reported in the <code class="docutils literal notranslate"><span class="pre">dmesg</span></code> log. That information
may not be enough to debug a specific issue, and the recommendation is
to add the following options to the <code class="docutils literal notranslate"><span class="pre">/etc/modprobe.d/sof-dyndbg.conf</span></code>
file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="n">snd_sof_intel_byt</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">snd_sof_intel_bdw</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">snd_sof_intel_ipc</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">snd_sof_intel_hda_common</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">snd_sof_intel_hda</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">snd_sof</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">snd_sof_pci</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">snd_sof_acpi</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">snd_sof_of</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">snd_sof_nocodec</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">soundwire_bus</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">soundwire_generic_allocation</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">soundwire_cadence</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">soundwire_intel_init</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">soundwire_intel</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">snd_soc_skl_hda_dsp</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
<span class="n">options</span> <span class="n">snd_intel_dspcfg</span> <span class="n">dyndbg</span><span class="o">=+</span><span class="n">p</span>
</pre></div>
</div>
<p>Note that this list is only an example.</p>
</div>
<div class="section" id="install-sof-logger">
<h2>Install sof-logger<a class="headerlink" href="#install-sof-logger" title="Permalink to this headline">¶</a></h2>
<p>If an issue with the SOF firmware is reported, such as IPC errors, SOF
developers will need DSP traces. This is typically done by installing
<code class="docutils literal notranslate"><span class="pre">/usr/local/bin/sof-logger</span></code> as well as the <code class="docutils literal notranslate"><span class="pre">.ldc</span></code> file, and using the
following command to extract DSP traces:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sof-logger -t sof-tgl.ldc
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../architectures/index.html" class="btn btn-neutral float-right" title="Supported Architectures" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="introduction.html" class="btn btn-neutral" title="Overview of Intel hardware platforms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; Copyright 2021, SOF Project..
      Last updated on May 10, 2022.

    </p>
</td>
<td id="zcanlogo">
  <a href="https://www.unisim-micro.com/"><img src="../../_static/images/zcan.svg" border="0" style="position:static"/></a>
</td>
</tr>
</table>
  </div> 


</footer>
        </div>
      </div>

    </section>

  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> SOF Project</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version zcansdk">
        <a href="../../../zcansdk/index.html">ZCAN IOT SDK</a>
      </div>
      
      <div class="rst-other-version zcanxlib">
        <a href="../../../zcanxlib/README.html">ZCAN Xlib</a>
      </div>
      
      <div class="rst-other-version zephyr">
        <a href="../../../zephyr/index.html">Zephyr Project</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="../../../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="../../../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>