

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Modifying a sample application &mdash; ZCAN IOT SDK 0.0.01 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/zc.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/zc.css" type="text/css" />
  <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/common.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/zcansdk.css" type="text/css" />

  
  

  
  

  

  
  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-210766333-2"></script>
        <script src="_static/js/ga-tracker.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
  <script type="text/javascript" src="_static/js/zcaniot.js"></script>

    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Protocols" href="protocols.html" />
    <link rel="prev" title="Testing a sample application" href="gs_testing.html" />
  <link rel="shortcut icon" href="_static/images/favicon.ico"/>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ZCAN IOT SDK
          

          
          </a>

          
            
            
              <div class="version">
                0.0.01
              </div>
            
          

          
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">About the ZCAN IOT SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="documentation.html">About this documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="getting_started.html">Getting started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="gs_ins_os.html">Supported operating systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_recommended_versions.html">Required tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_installing.html">Installing the ZCAN IOT SDK manually</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_programming.html">Building and programming a sample application</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_testing.html">Testing a sample application</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Modifying a sample application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adding-files-and-changing-compiler-settings">Adding files and changing compiler settings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#editing-cmakelists-txt-directly">Editing CMakeLists.txt directly</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-your-application">Configuring your application</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#changing-the-configuration-permanently">Changing the configuration permanently</a></li>
<li class="toctree-l4"><a class="reference internal" href="#changing-the-configuration-temporarily">Changing the configuration temporarily</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#providing-cmake-options">Providing CMake options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-build-types">Configuring build types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-build-type-files">Creating build type files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#selecting-a-build-type-from-command-line">Selecting a build type from command line</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="protocols.html">Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Applications and samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="drivers.html">Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="libraries.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ZCAN IOT SDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="getting_started.html">Getting started</a> &raquo;</li>
        
      <li>Modifying a sample application</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/gs_modifying.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="modifying-a-sample-application">
<span id="gs-modifying"></span><h1>Modifying a sample application<a class="headerlink" href="#modifying-a-sample-application" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#adding-files-and-changing-compiler-settings" id="id1">Adding files and changing compiler settings</a></p>
<ul>
<li><p><a class="reference internal" href="#editing-cmakelists-txt-directly" id="id2">Editing CMakeLists.txt directly</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#configuring-your-application" id="id3">Configuring your application</a></p>
<ul>
<li><p><a class="reference internal" href="#changing-the-configuration-permanently" id="id4">Changing the configuration permanently</a></p></li>
<li><p><a class="reference internal" href="#changing-the-configuration-temporarily" id="id5">Changing the configuration temporarily</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#providing-cmake-options" id="id6">Providing CMake options</a></p></li>
<li><p><a class="reference internal" href="#configuring-build-types" id="id7">Configuring build types</a></p>
<ul>
<li><p><a class="reference internal" href="#creating-build-type-files" id="id8">Creating build type files</a></p></li>
<li><p><a class="reference internal" href="#selecting-a-build-type-from-command-line" id="id9">Selecting a build type from command line</a></p></li>
</ul>
</li>
</ul>
</div>
<p>After programming and testing a sample application, you probably want to make some modifications to the application, for example, add your own files with additional functionality, change compilation options, or update the default configuration.</p>
<div class="section" id="adding-files-and-changing-compiler-settings">
<h2><a class="toc-backref" href="#id1">Adding files and changing compiler settings</a><a class="headerlink" href="#adding-files-and-changing-compiler-settings" title="Permalink to this headline">¶</a></h2>
<p>All files that your application uses must be specified in the <code class="file docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file.
By default, most samples include only the main application file <code class="file docutils literal notranslate"><span class="pre">src/main.c</span></code>.
This means that you must add all other files that you are using.</p>
<p>You can also configure compiler options, application defines, or include directories, or set <a class="reference internal" href="#gs-modifying-build-types"><span class="std std-ref">build types</span></a> in <code class="file docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>.</p>
<div class="section" id="editing-cmakelists-txt-directly">
<h3><a class="toc-backref" href="#id2">Editing CMakeLists.txt directly</a><a class="headerlink" href="#editing-cmakelists-txt-directly" title="Permalink to this headline">¶</a></h3>
<p>Add all files that your application uses to the <code class="docutils literal notranslate"><span class="pre">target_sources</span></code> function in <code class="file docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>.
To include several files, it can be useful to specify them with a wildcard.
For example, to include all <code class="file docutils literal notranslate"><span class="pre">.c</span></code> files from the <code class="file docutils literal notranslate"><span class="pre">src</span></code> folder, add the following lines to your <code class="file docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>FILE(GLOB app_sources src/*.c)
target_sources(app PRIVATE ${app_sources})
</pre></div>
</div>
<p>Instead of specifying each file (explicitly or with a wildcard), you can include all files from a folder by adding that folder as include folder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">target_include_directories</span><span class="p">(</span><span class="n">app</span> <span class="n">PRIVATE</span> <span class="n">src</span><span class="p">)</span>
</pre></div>
</div>
<p>See the <a class="reference external" href="https://cmake.org/cmake/help/latest/">CMake documentation</a> and <a class="reference external" href="..\zephyr\guides/build/index.html#cmake-details" title="(in Zephyr Project v3.0.99)"><span>Build System (CMake)</span></a> in the Zephyr documentation for more information about how to edit <code class="file docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>.</p>
</div>
</div>
<div class="section" id="configuring-your-application">
<span id="configure-application"></span><h2><a class="toc-backref" href="#id3">Configuring your application</a><a class="headerlink" href="#configuring-your-application" title="Permalink to this headline">¶</a></h2>
<p>If your application uses a provided library or targets a specific board, you might want to change the default configuration of the library or board.
There are different ways of doing this, but not all will store your configuration permanently.</p>
<p>The default configuration for a library is specified in its <code class="file docutils literal notranslate"><span class="pre">Kconfig</span></code> file.
Similarly, the default configuration for a board is specified in its <code class="file docutils literal notranslate"><span class="pre">*_defconfig</span></code> file (and its <code class="file docutils literal notranslate"><span class="pre">Kconfig.defconfig</span></code> file, see <a class="reference external" href="..\zephyr\guides/porting/board_porting.html#default-board-configuration" title="(in Zephyr Project v3.0.99)"><span>Write your devicetree</span></a> in the Zephyr documentation for more information).
The configuration for your application, which might override some default options of the libraries or the board, is specified in a <code class="file docutils literal notranslate"><span class="pre">prj.conf</span></code> file in the application directory.</p>
<p>For detailed information about configuration options, see <a class="reference external" href="..\zephyr\application/index.html#application-kconfig" title="(in Zephyr Project v3.0.99)"><span>Kconfig Configuration</span></a> in the Zephyr documentation.</p>
<div class="section" id="changing-the-configuration-permanently">
<h3><a class="toc-backref" href="#id4">Changing the configuration permanently</a><a class="headerlink" href="#changing-the-configuration-permanently" title="Permalink to this headline">¶</a></h3>
<p>To configure your application and maintain the configuration when you clean the build directory, add your changes to the <code class="file docutils literal notranslate"><span class="pre">prj.conf</span></code> file in your application directory.
In this file, you can specify different values for configuration options that are defined by a library or board, and you can add configuration options that are specific to your application.</p>
<p>See <a class="reference external" href="..\zephyr\guides/build/kconfig/setting.html#setting-configuration-values" title="(in Zephyr Project v3.0.99)"><span>Setting Kconfig configuration values</span></a> in the Zephyr documentation for information on how to edit the <code class="file docutils literal notranslate"><span class="pre">prj.conf</span></code> file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is possible to change the default configuration for a library by changing the <code class="file docutils literal notranslate"><span class="pre">Kconfig</span></code> file of the library.
However, best practice is to override the configuration in the application configuration file <code class="file docutils literal notranslate"><span class="pre">prj.conf</span></code>.</p>
</div>
</div>
<div class="section" id="changing-the-configuration-temporarily">
<h3><a class="toc-backref" href="#id5">Changing the configuration temporarily</a><a class="headerlink" href="#changing-the-configuration-temporarily" title="Permalink to this headline">¶</a></h3>
<p>When building your application, the different <code class="file docutils literal notranslate"><span class="pre">Kconfig</span></code> and <code class="file docutils literal notranslate"><span class="pre">*_defconfig</span></code> files and the <code class="file docutils literal notranslate"><span class="pre">prj.conf</span></code> file are merged together.
The combined configuration is saved in a <code class="file docutils literal notranslate"><span class="pre">zephyr/.config</span></code> file in your build directory.
This means that this file is available when building the application, but it is deleted when you clean the build directory.</p>
<p>To quickly test different configuration options, or to build your application in different variants, you can update the <code class="file docutils literal notranslate"><span class="pre">.config</span></code> file in the build directory.
Changes are picked up immediately.</p>
<p>While it is possible to edit the <code class="file docutils literal notranslate"><span class="pre">.config</span></code> file directly, you should use a tool like menuconfig or guiconfig to update it.
These tools present all available options and allow you to select the ones that you need.</p>
<p>If your application contains more than one image , you must select the correct target.
To configure the parent image (the main application), select <span class="guilabel">menuconfig</span>.
The other options allow you to configure the child images.</p>
<p>See <a class="reference external" href="..\zephyr\guides/build/kconfig/menuconfig.html#menuconfig" title="(in Zephyr Project v3.0.99)"><span>Interactive Kconfig interfaces</span></a> in the Zephyr documentation for instructions on how to run menuconfig or guiconfig.</p>
<p>To locate a specific configuration option, use the filter (<span class="guilabel">Jump to</span> in menuconfig and guiconfig).
The documentation for each <a class="reference external" href="..\kconfig\index.html#configuration-options" title="(in Kconfig reference v&amp;nbsp;)"><span class="xref std std-ref">configuration option</span></a> also lists the menu path where the option can be found.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>All changes to the <code class="file docutils literal notranslate"><span class="pre">.config</span></code> file are lost when you clean your build directory.
You can save it to another location, but you must then manually copy it back to your build directory.</p>
</div>
</div>
</div>
<div class="section" id="providing-cmake-options">
<span id="cmake-options"></span><h2><a class="toc-backref" href="#id6">Providing CMake options</a><a class="headerlink" href="#providing-cmake-options" title="Permalink to this headline">¶</a></h2>
<p>You can provide additional options for building your application to the CMake process, which can be useful, for example, to switch between different build scenarios.
These options are specified when CMake is run, thus not during the actual build, but when configuring the build.</p>
<ul class="simple">
<li><p>Specify project-specific CMake options when opening the ZCAN IOT SDK project.
Click <span class="guilabel">File</span> &gt; <span class="guilabel">Open ZCAN IOT SDK project</span>, select <span class="guilabel">Extended Settings</span>, and specify the options in the <span class="guilabel">Extra CMake Build Options</span> field.
This field is prepopulated with the global CMake options, and you can modify them, remove them, or add to them for the current project.</p></li>
</ul>
<p>If you work on the command line, pass the additional options to the <code class="docutils literal notranslate"><span class="pre">west</span> <span class="pre">build</span></code> command.
The options must be added after a <code class="docutils literal notranslate"><span class="pre">--</span></code> at the end of the command.
See <a class="reference external" href="..\zephyr\guides/west/build-flash-debug.html#west-building-cmake-args" title="(in Zephyr Project v3.0.99)"><span>One-Time CMake Arguments</span></a> for more information.</p>
</div>
<div class="section" id="configuring-build-types">
<span id="gs-modifying-build-types"></span><h2><a class="toc-backref" href="#id7">Configuring build types</a><a class="headerlink" href="#configuring-build-types" title="Permalink to this headline">¶</a></h2>
<p>Build types enable you to use different sets of configuration options for each board.
You can create several build type <code class="file docutils literal notranslate"><span class="pre">.conf</span></code> files per board and select one of them when building the application.
This means that you do not have to use one <code class="file docutils literal notranslate"><span class="pre">prj.conf</span></code> file for your project and modify it each time to fit your needs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Creating build types and selecting them is optional.
This is a feature specific to the <span class="xref std std-ref">application development in ZCAN IOT SDK</span>.</p>
</div>
<div class="section" id="creating-build-type-files">
<span id="gs-modifying-build-types-creating"></span><h3><a class="toc-backref" href="#id8">Creating build type files</a><a class="headerlink" href="#creating-build-type-files" title="Permalink to this headline">¶</a></h3>
<p>To create custom build type files for your application instead of using a single <code class="file docutils literal notranslate"><span class="pre">prj.conf</span></code> file, complete the following steps:</p>
<ol class="arabic">
<li><p>During <a class="reference external" href="..\zephyr\application/index.html#application" title="(in Zephyr Project v3.0.99)"><span class="xref std std-ref">application development</span></a>, follow the procedure for creating the application until after the step where you create the <code class="file docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file.</p></li>
<li><p>In the <code class="file docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file, define the file name pattern for configuration files.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">CONF_FILE</span> <span class="s2">&quot;app_$</span><span class="si">{CMAKE_BUILD_TYPE}</span><span class="s2">.conf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this define, <code class="docutils literal notranslate"><span class="pre">CMAKE_BUILD_TYPE</span></code> will be used for selecting the build type.</p>
</li>
<li><p>Continue the application creation procedure by setting the Kconfig configuration options.</p></li>
<li><p>Save the <code class="file docutils literal notranslate"><span class="pre">.conf</span></code> file in the application directory with a name that matches the file name pattern defined in CMakeLists.
For example, <code class="file docutils literal notranslate"><span class="pre">app_ZRelease.conf</span></code>.
In this file name, <code class="docutils literal notranslate"><span class="pre">ZRelease</span></code> is the build type name.</p></li>
</ol>
</div>
<div class="section" id="selecting-a-build-type-from-command-line">
<h3><a class="toc-backref" href="#id9">Selecting a build type from command line</a><a class="headerlink" href="#selecting-a-build-type-from-command-line" title="Permalink to this headline">¶</a></h3>
<p>To select the build type when building the application from command line, specify the build type by adding the following parameter to the <code class="docutils literal notranslate"><span class="pre">west</span> <span class="pre">build</span></code> command:</p>
<pre class="highlight literal-block">-- -DCMAKE_BUILD_TYPE=<em>selected_build_type</em></pre>
<p>For example, you can replace the <em>selected_build_type</em> variable to build the <code class="docutils literal notranslate"><span class="pre">ZRelease</span></code> firmware for ZC3827 by running the following command in the project directory:</p>
<div class="highlight highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">west</span> <span class="n">build</span> <span class="o">-</span><span class="n">b</span> <span class="n">zc3827_demo</span> <span class="o">-</span><span class="n">d</span> <span class="n">build_zc3827</span> <span class="o">--</span> <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="o">=</span><span class="n">ZRelease</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">build_zc3827</span></code> parameter specifies the output directory for the build files.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="protocols.html" class="btn btn-neutral float-right" title="Protocols" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="gs_testing.html" class="btn btn-neutral" title="Testing a sample application" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; Copyright 2019-2022, ZCAN.
      Last updated on May 10, 2022.

    </p>
</td>
<td id="zcanlogo">
  <a href="https://www.unisim-micro.com/"><img src="_static/images/zcan.svg" border="0" style="position:static"/></a>
</td>
</tr>
</table>
  </div> 


</footer>
        </div>
      </div>

    </section>

  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> ZCAN IOT SDK</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version zcanxlib">
        <a href="./../zcanxlib/README.html">ZCAN Xlib</a>
      </div>
      
      <div class="rst-other-version zephyr">
        <a href="./../zephyr/index.html">Zephyr Project</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="./../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version sof">
        <a href="./../sof/index.html">SOF</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="./../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>