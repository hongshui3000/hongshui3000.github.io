

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Bluetooth tools &mdash; Zephyr Project Documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/zc.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/zc.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/common.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/zephyr.css" type="text/css" />

  
  

  
  

  

  
  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-210766333-2"></script>
        <script src="../../_static/js/ga-tracker.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
  <script type="text/javascript" src="../../_static/js/zcaniot.js"></script>

    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="Developing Bluetooth Applications" href="bluetooth-dev.html" />
    <link rel="prev" title="DIS ICS" href="dis-pics.html" />
  <link rel="shortcut icon" href="../../_static/images/favicon.ico"/>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Zephyr Project
          

          
          </a>

          
            
            
              <div class="version">
                3.0.99
              </div>
            
          

          
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../application/index.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">API Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User and Developer Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../beyond-GSG.html">Beyond the Getting Started Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../arch/index.html">Architecture-related Guides</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Bluetooth</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluetooth-arch.html">Bluetooth Stack Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="bluetooth-qual.html">Bluetooth Qualification</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Bluetooth tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mobile-applications">Mobile applications</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-bluez-with-zephyr">Using BlueZ with Zephyr</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-on-qemu-and-native-posix">Running on QEMU and Native POSIX</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-zephyr-based-controllers-with-bluez">Using Zephyr-based Controllers with BlueZ</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="bluetooth-dev.html">Developing Bluetooth Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="autopts/autopts-win10.html">AutoPTS on Windows 10 with nRF52 board</a></li>
<li class="toctree-l3"><a class="reference internal" href="autopts/autopts-linux.html">AutoPTS on Linux</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../docs/index.html">Documentation Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coccinelle.html">Coccinelle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../code-relocation.html">Code And Data Relocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../crypto/index.html">Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../flash_debug/index.html">Flashing and Hardware Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debug_tools/index.html">Debugging and Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../device_mgmt/index.html">Device Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dts/index.html">Devicetree Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env_vars.html">Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pinctrl/index.html">Pin Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pm/index.html">Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../emulator/index.html">Peripheral and Hardware Emulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html">Modules (External projects)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking/index.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../platformio/index.html">Using with PlatformIO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../portability/index.html">OS Abstraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../porting/index.html">Porting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../smf/index.html">State Machine Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test/index.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tfm/index.html">Trusted Firmware-M</a></li>
<li class="toctree-l2"><a class="reference internal" href="../west/index.html">West (Zephyr’s meta-tool)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimizations/index.html">Optimizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zephyr_cmake_package.html">Zephyr CMake Package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../samples/index.html">Samples and Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/index.html">Release Notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Zephyr Project</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">User and Developer Guides</a> &raquo;</li>
        
          <li><a href="index.html">Bluetooth</a> &raquo;</li>
        
      <li>Bluetooth tools</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/guides/bluetooth/bluetooth-tools.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="bluetooth-tools">
<span id="id1"></span><h1>Bluetooth tools<a class="headerlink" href="#bluetooth-tools" title="Permalink to this headline">¶</a></h1>
<p>This page lists and describes tools that can be used to assist during Bluetooth
stack or application development in order to help, simplify and speed up the
development process.</p>
<div class="section" id="mobile-applications">
<span id="bluetooth-mobile-apps"></span><h2>Mobile applications<a class="headerlink" href="#mobile-applications" title="Permalink to this headline">¶</a></h2>
<p>It is often useful to make use of existing mobile applications to interact with
hardware running Zephyr, to test functionality without having to write any
additional code or requiring extra hardware.</p>
<p>The recommended mobile applications for interacting with Zephyr are:</p>
<ul class="simple">
<li><p>Android:</p>
<ul>
<li><p><a class="reference external" href="https://play.google.com/store/apps/details?id=no.nordicsemi.android.mcp&amp;hl=en">nRF Connect for Android</a></p></li>
<li><p><a class="reference external" href="https://play.google.com/store/apps/details?id=no.nordicsemi.android.nrfmeshprovisioner&amp;hl=en">nRF Mesh for Android</a></p></li>
<li><p><a class="reference external" href="https://play.google.com/store/apps/details?id=com.punchthrough.lightblueexplorer&amp;hl=en_US">LightBlue for Android</a></p></li>
</ul>
</li>
<li><p>iOS:</p>
<ul>
<li><p><a class="reference external" href="https://itunes.apple.com/us/app/nrf-connect/id1054362403">nRF Connect for iOS</a></p></li>
<li><p><a class="reference external" href="https://itunes.apple.com/us/app/nrf-mesh/id1380726771">nRF Mesh for iOS</a></p></li>
<li><p><a class="reference external" href="https://itunes.apple.com/us/app/lightblue-explorer/id557428110">LightBlue for iOS</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="using-bluez-with-zephyr">
<span id="bluetooth-bluez"></span><h2>Using BlueZ with Zephyr<a class="headerlink" href="#using-bluez-with-zephyr" title="Permalink to this headline">¶</a></h2>
<p>The Linux Bluetooth Protocol Stack, BlueZ, comes with a very useful set of
tools that can be used to debug and interact with Zephyr’s BLE Host and
Controller. In order to benefit from these tools you will need to make sure
that you are running a recent version of the Linux Kernel and BlueZ:</p>
<ul class="simple">
<li><p>Linux Kernel 4.10+</p></li>
<li><p>BlueZ 4.45+</p></li>
</ul>
<p>Additionally, some of the BlueZ tools might not be bundled by default by your
Linux distribution. If you need to build BlueZ from scratch to update to a
recent version or to obtain all of its tools you can follow the steps below:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">git clone git://git.kernel.org/pub/scm/bluetooth/bluez.git</span>
<span class="go">cd bluez</span>
<span class="go">./bootstrap-configure --disable-android --disable-midi</span>
<span class="go">make</span>
</pre></div>
</div>
<p>You can then find <code class="file docutils literal notranslate"><span class="pre">btattach</span></code>, <code class="file docutils literal notranslate"><span class="pre">btmgt</span></code> and <code class="file docutils literal notranslate"><span class="pre">btproxy</span></code> in the
<code class="file docutils literal notranslate"><span class="pre">tools/</span></code> folder and <code class="file docutils literal notranslate"><span class="pre">btmon</span></code> in the <code class="file docutils literal notranslate"><span class="pre">monitor/</span></code> folder.</p>
<p>You’ll need to enable BlueZ’s experimental features so you can access its
most recent BLE functionality. Do this by editing the file
<code class="file docutils literal notranslate"><span class="pre">/lib/systemd/system/bluetooth.service</span></code>
and making sure to include the <code class="docutils literal notranslate"><span class="pre">-E</span></code> option in the daemon’s execution
start line:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ExecStart=/usr/libexec/bluetooth/bluetoothd -E</span>
</pre></div>
</div>
<p>Finally, reload and restart the daemon:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sudo systemctl daemon-reload</span>
<span class="go">sudo systemctl restart bluetooth</span>
</pre></div>
</div>
</div>
<div class="section" id="running-on-qemu-and-native-posix">
<span id="bluetooth-qemu-posix"></span><h2>Running on QEMU and Native POSIX<a class="headerlink" href="#running-on-qemu-and-native-posix" title="Permalink to this headline">¶</a></h2>
<p>It’s possible to run Bluetooth applications using either the <a class="reference internal" href="../../application/index.html#application-run-qemu"><span class="std std-ref">QEMU
emulator</span></a> or <a class="reference internal" href="../../boards/posix/native_posix/doc/index.html#native-posix"><span class="std std-ref">Native POSIX</span></a>.
In either case, a Bluetooth controller needs to be exported from
the host OS (Linux) to the emulator. For this purpose you will need some tools
described in the <a class="reference internal" href="#bluetooth-bluez"><span class="std std-ref">Using BlueZ with Zephyr</span></a> section.</p>
<div class="section" id="using-the-host-system-bluetooth-controller">
<h3>Using the Host System Bluetooth Controller<a class="headerlink" href="#using-the-host-system-bluetooth-controller" title="Permalink to this headline">¶</a></h3>
<p>The host OS’s Bluetooth controller is connected in the following manner:</p>
<ul class="simple">
<li><p>To the second QEMU serial line using a UNIX socket. This socket gets used
with the help of the QEMU option <code class="docutils literal notranslate"><span class="pre">-serial</span> <span class="pre">unix:/tmp/bt-server-bredr</span></code>.
This option gets passed to QEMU through <strong class="makevar">QEMU_EXTRA_FLAGS</strong>
automatically whenever an application has enabled Bluetooth support.</p></li>
<li><p>To a serial port in Native POSIX through the use of a command-line option
passed to the Native POSIX executable: <code class="docutils literal notranslate"><span class="pre">--bt-dev=hci0</span></code></p></li>
</ul>
<p>On the host side, BlueZ allows you to export its Bluetooth controller
through a so-called user channel for QEMU and Native POSIX to use.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You only need to run <code class="docutils literal notranslate"><span class="pre">btproxy</span></code> when using QEMU. Native POSIX handles
the UNIX socket proxying automatically</p>
</div>
<p>If you are using QEMU, in order to make the Controller available you will need
one additional step using <code class="docutils literal notranslate"><span class="pre">btproxy</span></code>:</p>
<ol class="arabic">
<li><p>Make sure that the Bluetooth controller is down</p></li>
<li><p>Use the btproxy tool to open the listening UNIX socket, type:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sudo tools/btproxy -u -i 0</span>
<span class="go">Listening on /tmp/bt-server-bredr</span>
</pre></div>
</div>
<p>You might need to replace <code class="docutils literal notranslate"><span class="pre">-i</span> <span class="pre">0</span></code> with the index of the Controller
you wish to proxy.</p>
</li>
</ol>
<p>Once the hardware is connected and ready to use, you can then proceed to
building and running a sample:</p>
<ul>
<li><p>Choose one of the Bluetooth sample applications located in
<code class="docutils literal notranslate"><span class="pre">samples/bluetooth</span></code>.</p></li>
<li><p>To run a Bluetooth application in QEMU, type:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">west build -b qemu_x86 samples/bluetooth/&lt;sample&gt;</span>
<span class="go">west build -t run</span>
</pre></div>
</div>
<p>Running QEMU now results in a connection with the second serial line to
the <code class="docutils literal notranslate"><span class="pre">bt-server-bredr</span></code> UNIX socket, letting the application
access the Bluetooth controller.</p>
</li>
<li><p>To run a Bluetooth application in Native POSIX, first build it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">west build -b native_posix samples/bluetooth/&lt;sample&gt;</span>
</pre></div>
</div>
<p>And then run it with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo ./build/zephyr/zephyr.exe --bt-dev=hci0
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="using-a-zephyr-based-ble-controller">
<h3>Using a Zephyr-based BLE Controller<a class="headerlink" href="#using-a-zephyr-based-ble-controller" title="Permalink to this headline">¶</a></h3>
<p>Depending on which hardware you have available, you can choose between two
transports when building a single-mode, Zephyr-based BLE Controller:</p>
<ul class="simple">
<li><p>UART: Use the <a class="reference internal" href="../../samples/bluetooth/hci_uart/README.html#bluetooth-hci-uart-sample"><span class="std std-ref">hci_uart</span></a> sample and follow
the instructions in <a class="reference internal" href="../../samples/bluetooth/hci_uart/README.html#bluetooth-hci-uart-qemu-posix"><span class="std std-ref">Using the controller with QEMU and Native POSIX</span></a>.</p></li>
<li><p>USB: Use the <a class="reference internal" href="../../samples/bluetooth/hci_usb/README.html#bluetooth-hci-usb-sample"><span class="std std-ref">hci_usb</span></a> sample and then
treat it as a Host System Bluetooth Controller (see previous section)</p></li>
</ul>
</div>
<div class="section" id="hci-tracing">
<h3>HCI Tracing<a class="headerlink" href="#hci-tracing" title="Permalink to this headline">¶</a></h3>
<p>When running the Host on a computer connected to an external Controller, it
is very useful to be able to see the full log of exchanges between the two,
in the format of a <a class="reference internal" href="bluetooth-arch.html#bluetooth-hci"><span class="std std-ref">Host Controller Interface</span></a> log.
In order to see those logs, you can use the built-in <code class="docutils literal notranslate"><span class="pre">btmon</span></code> tool from BlueZ:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>btmon
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-zephyr-based-controllers-with-bluez">
<span id="bluetooth-ctlr-bluez"></span><h2>Using Zephyr-based Controllers with BlueZ<a class="headerlink" href="#using-zephyr-based-controllers-with-bluez" title="Permalink to this headline">¶</a></h2>
<p>If you want to test a Zephyr-powered BLE Controller using BlueZ’s Bluetooth
Host, you will need a few tools described in the <a class="reference internal" href="#bluetooth-bluez"><span class="std std-ref">Using BlueZ with Zephyr</span></a> section.
Once you have installed the tools you can then use them to interact with your
Zephyr-based controller:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sudo tools/btmgmt --index 0</span>
<span class="gp">[hci0]# </span>auto-power
<span class="gp">[hci0]# </span>find -l
</pre></div>
</div>
</div></blockquote>
<p>You might need to replace <code class="docutils literal notranslate"><span class="pre">--index</span> <span class="pre">0</span></code> with the index of the Controller
you wish to manage.
Additional information about <code class="file docutils literal notranslate"><span class="pre">btmgmt</span></code> can be found in its manual pages.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bluetooth-dev.html" class="btn btn-neutral float-right" title="Developing Bluetooth Applications" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dis-pics.html" class="btn btn-neutral" title="DIS ICS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; <a href="../../copyright.html">Copyright</a> 2015-2022 Zephyr Project members and individual contributors.
      Last updated on May 10, 2022.

    </p>
</td>
<td id="zcanlogo">
  <a href="https://www.unisim-micro.com/"><img src="../../_static/images/zcan.svg" border="0" style="position:static"/></a>
</td>
</tr>
</table>
  </div> 


</footer>
        </div>
      </div>

    </section>

  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version zcansdk">
        <a href="../../../zcansdk/index.html">ZCAN IOT SDK</a>
      </div>
      
      <div class="rst-other-version zcanxlib">
        <a href="../../../zcanxlib/README.html">ZCAN Xlib</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="../../../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version sof">
        <a href="../../../sof/index.html">SOF</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="../../../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>