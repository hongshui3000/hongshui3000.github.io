

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Up Squared Audio DSP &mdash; Zephyr Project Documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/zc.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/zc.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/common.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/zephyr.css" type="text/css" />

  
  

  
  

  

  
  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-210766333-2"></script>
        <script src="../../../../_static/js/ga-tracker.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
  <script type="text/javascript" src="../../../../_static/js/zcaniot.js"></script>

    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../../copyright.html" />
    <link rel="next" title="Zephyr Audio DSP Development on Chromebooks" href="../../intel_adsp_cavs25/doc/index.html" />
    <link rel="prev" title="Heltec WiFi LoRa 32 (V2)" href="../../heltec_wifi_lora32_v2/doc/index.html" />
  <link rel="shortcut icon" href="../../../../_static/images/favicon.ico"/>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Zephyr Project
          

          
          </a>

          
            
            
              <div class="version">
                3.0.99
              </div>
            
          

          
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../guides/build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../application/index.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../guides/index.html">User and Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../samples/index.html">Samples and Demos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Supported Boards</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../x86/index.html">x86 Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../arm/index.html">ARM Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../arm64/index.html">ARM64 Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../arc/index.html">ARC Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../mips/index.html">MIPS Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nios2/index.html">NIOS II Boards</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">XTENSA Boards</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../esp32/doc/index.html">ESP32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../esp32s2_saola/doc/index.html">ESP32-S2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../esp_wrover_kit/doc/index.html">ESP-WROVER-KIT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../heltec_wifi_lora32_v2/doc/index.html">Heltec WiFi LoRa 32 (V2)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Up Squared Audio DSP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#system-requirements">System Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#programming-and-debugging">Programming and Debugging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../intel_adsp_cavs25/doc/index.html">Zephyr Audio DSP Development on Chromebooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../intel_s1000_crb/doc/index.html">Intel S1000 CRB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../odroid_go/doc/index.html">ODROID-GO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../qemu_xtensa/doc/index.html">Xtensa Emulation (QEMU)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../xt-sim/doc/index.html">Xtensa simulator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../posix/index.html">POSIX/NATIVE Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../riscv/index.html">RISCV Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../sparc/index.html">SPARC Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../shields/index.html">Shields</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../releases/index.html">Release Notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Zephyr Project</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Supported Boards</a> &raquo;</li>
        
          <li><a href="../../index.html">XTENSA Boards</a> &raquo;</li>
        
      <li>Up Squared Audio DSP</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../_sources/boards/xtensa/intel_adsp_cavs15/doc/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="up-squared-audio-dsp">
<span id="id1"></span><h1>Up Squared Audio DSP<a class="headerlink" href="#up-squared-audio-dsp" title="Permalink to this headline">¶</a></h1>
<div class="section" id="system-requirements">
<h2>System Requirements<a class="headerlink" href="#system-requirements" title="Permalink to this headline">¶</a></h2>
<div class="section" id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<p>The Zephyr SDK 0.11 or higher is required.</p>
<p>Since firmware binary signing for Audio DSP is mandatory on Intel products
form Skylake onwards the signing tool and key are needed.</p>
<p><code class="docutils literal notranslate"><span class="pre">up_squared</span></code> board is running Linux with <a class="reference external" href="https://github.com/thesofproject/sof-diagnostic-driver">SOF Diagnostic Driver</a> <a class="footnote-reference brackets" href="#id4" id="id5">2</a> built and
loaded.</p>
<div class="section" id="signing-tool">
<h4>Signing tool<a class="headerlink" href="#signing-tool" title="Permalink to this headline">¶</a></h4>
<p>rimage is Audio DSP firmware image creation and signing tool. The tool is used
by <a class="reference external" href="https://github.com/thesofproject/sof">Sound Open Firmware</a> <a class="footnote-reference brackets" href="#id8" id="id9">3</a> to generate binary firmware signed images.</p>
<p>For the building instructions refer to <a class="reference external" href="https://github.com/thesofproject/rimage#building">rimage Build Instructions</a> <a class="footnote-reference brackets" href="#id10" id="id11">4</a>.</p>
</div>
<div class="section" id="signing-keys">
<h4>Signing keys<a class="headerlink" href="#signing-keys" title="Permalink to this headline">¶</a></h4>
<p>The key used is Intel Open Source Technology Center (OTC) community key.
It can be freely used by anyone and intended for firmware developers.
Please download and store private key from the location:
<a class="reference external" href="https://github.com/thesofproject/sof/blob/master/keys/otc_private_key.pem">https://github.com/thesofproject/sof/blob/master/keys/otc_private_key.pem</a></p>
<p>For more information about keys refer to <a class="reference external" href="https://github.com/thesofproject/sof/tree/master/rimage/keys">rimage keys</a> <a class="footnote-reference brackets" href="#id12" id="id13">5</a>.</p>
</div>
<div class="section" id="setup-up-squared-board">
<h4>Setup up_squared board<a class="headerlink" href="#setup-up-squared-board" title="Permalink to this headline">¶</a></h4>
<p>To setup Linux on <code class="docutils literal notranslate"><span class="pre">up_squared</span></code> board refer to
<a class="reference external" href="https://software.intel.com/en-us/articles/getting-started-with-ubuntu-core-on-an-up-squared-board">Getting Started with Ubuntu Core on an UP Squared Board</a> <a class="footnote-reference brackets" href="#id2" id="id3">1</a>.</p>
<p>After installing Linux build and install <a class="reference external" href="https://github.com/thesofproject/sof-diagnostic-driver">SOF Diagnostic Driver</a> <a class="footnote-reference brackets" href="#id4" id="id6">2</a>.</p>
</div>
</div>
</div>
<div class="section" id="programming-and-debugging">
<h2>Programming and Debugging<a class="headerlink" href="#programming-and-debugging" title="Permalink to this headline">¶</a></h2>
<div class="section" id="build-zephyr-application">
<h3>Build Zephyr application<a class="headerlink" href="#build-zephyr-application" title="Permalink to this headline">¶</a></h3>
<p>Applications can be build in the usual way (see <a class="reference internal" href="../../../../application/index.html#build-an-application"><span class="std std-ref">Building an Application</span></a>
for more details). The only additional step required is signing. For example,
for building <code class="docutils literal notranslate"><span class="pre">hello_world</span></code> application following steps are needed.</p>
<ol class="arabic">
<li><p>Building Zephyr application <code class="docutils literal notranslate"><span class="pre">hello_world</span></code></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>From the root of the zephyr repository
<span class="go">west build -b intel_adsp_cavs15 samples/hello_world</span>
</pre></div>
</div>
</li>
<li><p>Sign and create firmware image</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">west sign -t rimage -- -k &lt;path to otc_private_key.pem&gt;</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="loading-image-to-audio-dsp">
<h3>Loading image to Audio DSP<a class="headerlink" href="#loading-image-to-audio-dsp" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://github.com/thesofproject/sof-diagnostic-driver">SOF Diagnostic Driver</a> <a class="footnote-reference brackets" href="#id4" id="id7">2</a> provide interface for firmware loading. Python tools
in the board support directory use the interface to load firmware to <code class="docutils literal notranslate"><span class="pre">ADSP</span></code>.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">/dev/hda</span></code> device file created by the diagnostic
driver must be readable and writable by the process.  This can be
accomplished via a simple chmod, via a udev handler that associates
the device with a particular user or group, or simply by running the
loader script as root:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo chmod <span class="m">777</span> /dev/hda
<span class="gp">$ </span>boards/xtensa/intel_adsp_cavs15/tools/fw_loader.py -f &lt;path to zephyr.ri&gt;
</pre></div>
</div>
</div>
<div class="section" id="debugging">
<h3>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h3>
<p>The only way to debug application is using logging. Logging and ADSP logging
backend needs to be enabled in the application configuration.</p>
<p>ADSP logging backend writes logs to the ring buffer in the shared memory.</p>
<p>As above, the <code class="docutils literal notranslate"><span class="pre">adsplog</span></code> tool requires appropriate permissions, in
this case to the sysfs “resource4” device on the appropriate PCI
device.  This can likewise be managed via any filesystem, setuid or
udev trick the operator prefers.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>boards/xtensa/intel_adsp_cavs15/tools/adsplog.py
<span class="go">ERROR: Cannot open /sys/bus/pci/devices/0000:00:0e.0/resource4 for reading</span>

<span class="gp">$ </span>sudo chmod <span class="m">666</span> /sys/bus/pci/devices/0000:00:0e.0/resource4
<span class="gp">$ </span>boards/xtensa/intel_adsp_cavs15/tools/adsplog.py
<span class="go">Hello World! intel_adsp_cavs15</span>
</pre></div>
</div>
</div>
<div class="section" id="integration-testing-with-twister">
<h3>Integration Testing With Twister<a class="headerlink" href="#integration-testing-with-twister" title="Permalink to this headline">¶</a></h3>
<p>The ADSP hardware also has integration for testing using the twister
tool.  The <code class="docutils literal notranslate"><span class="pre">adsplog</span></code> script can be used as the
<code class="docutils literal notranslate"><span class="pre">--device-serial-pty</span></code> handler, and the west flash script should take
a path to the same key file used above.  Remember to pass the
<code class="docutils literal notranslate"><span class="pre">--no-history</span></code> argument to <code class="docutils literal notranslate"><span class="pre">adsplog.py</span></code>, because by default it
will dump the current log buffer, which may contain output from a
previous test run.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span>ZEPHYR_BASE/scripts/twister --device-testing -p intel_adsp_cavs15 <span class="se">\</span>
<span class="go">  --device-serial-pty $ZEPHYR_BASE/boards/xtensa/intel_adsp_cavs15/tools/adsplog.py,--no-history \</span>
<span class="go">  --west-flash $ZEPHYR_BASE/boards/xtensa/intel_adsp_cavs15/tools/flash.sh,$PATH_TO_KEYFILE.pem</span>
</pre></div>
</div>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id3">1</a></span></dt>
<dd><p><a class="reference external" href="https://software.intel.com/en-us/articles/getting-started-with-ubuntu-core-on-an-up-squared-board">https://software.intel.com/en-us/articles/getting-started-with-ubuntu-core-on-an-up-squared-board</a></p>
</dd>
<dt class="label" id="id4"><span class="brackets">2</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id6">2</a>,<a href="#id7">3</a>)</span></dt>
<dd><p><a class="reference external" href="https://github.com/thesofproject/sof-diagnostic-driver">https://github.com/thesofproject/sof-diagnostic-driver</a></p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id9">3</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/thesofproject/sof">https://github.com/thesofproject/sof</a></p>
</dd>
<dt class="label" id="id10"><span class="brackets"><a class="fn-backref" href="#id11">4</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/thesofproject/rimage#building">https://github.com/thesofproject/rimage#building</a></p>
</dd>
<dt class="label" id="id12"><span class="brackets"><a class="fn-backref" href="#id13">5</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/thesofproject/sof/tree/master/rimage/keys">https://github.com/thesofproject/sof/tree/master/rimage/keys</a></p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../intel_adsp_cavs25/doc/index.html" class="btn btn-neutral float-right" title="Zephyr Audio DSP Development on Chromebooks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../heltec_wifi_lora32_v2/doc/index.html" class="btn btn-neutral" title="Heltec WiFi LoRa 32 (V2)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; <a href="../../../../copyright.html">Copyright</a> 2015-2022 Zephyr Project members and individual contributors.
      Last updated on May 10, 2022.

    </p>
</td>
<td id="zcanlogo">
  <a href="https://www.unisim-micro.com/"><img src="../../../../_static/images/zcan.svg" border="0" style="position:static"/></a>
</td>
</tr>
</table>
  </div> 


</footer>
        </div>
      </div>

    </section>

  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version zcansdk">
        <a href="../../../../../zcansdk/index.html">ZCAN IOT SDK</a>
      </div>
      
      <div class="rst-other-version zcanxlib">
        <a href="../../../../../zcanxlib/README.html">ZCAN Xlib</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="../../../../../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version sof">
        <a href="../../../../../sof/index.html">SOF</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="../../../../../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>