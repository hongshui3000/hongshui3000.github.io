

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Elkhart Lake CRB &mdash; Zephyr Project Documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/zc.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/zc.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/common.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/zephyr.css" type="text/css" />

  
  

  
  

  

  
  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-210766333-2"></script>
        <script src="../../../../_static/js/ga-tracker.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
  <script type="text/javascript" src="../../../../_static/js/zcaniot.js"></script>

    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../../copyright.html" />
    <link rel="next" title="X86 Emulation (QEMU)" href="../../qemu_x86/doc/index.html" />
    <link rel="prev" title="Building and Running Zephyr with ACRN" href="../../acrn/doc/index.html" />
  <link rel="shortcut icon" href="../../../../_static/images/favicon.ico"/>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Zephyr Project
          

          
          </a>

          
            
            
              <div class="version">
                3.0.99
              </div>
            
          

          
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../guides/build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../application/index.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../guides/index.html">User and Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../samples/index.html">Samples and Demos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Supported Boards</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">x86 Boards</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../acrn/doc/index.html">Building and Running Zephyr with ACRN</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Elkhart Lake CRB</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hardware">Hardware</a></li>
<li class="toctree-l4"><a class="reference internal" href="#programming-and-debugging">Programming and Debugging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../qemu_x86/doc/index.html">X86 Emulation (QEMU)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../up_squared/doc/index.html">UP Squared</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../arm/index.html">ARM Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../arm64/index.html">ARM64 Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../arc/index.html">ARC Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../mips/index.html">MIPS Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nios2/index.html">NIOS II Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../xtensa/index.html">XTENSA Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../posix/index.html">POSIX/NATIVE Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../riscv/index.html">RISCV Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../sparc/index.html">SPARC Boards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../shields/index.html">Shields</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../releases/index.html">Release Notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Zephyr Project</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Supported Boards</a> &raquo;</li>
        
          <li><a href="../../index.html">x86 Boards</a> &raquo;</li>
        
      <li>Elkhart Lake CRB</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../_sources/boards/x86/ehl_crb/doc/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="elkhart-lake-crb">
<span id="ehl-crb"></span><h1>Elkhart Lake CRB<a class="headerlink" href="#elkhart-lake-crb" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Elkhart Lake Reference Board (EHL CRB) is an example implementation of a
compact single board computer with high performance for IoT edge devices.</p>
<p>This board configuration enables kernel support for the <a class="reference external" href="https://www.intel.com/content/www/us/en/products/docs/processors/embedded/enhanced-for-iot-platform-brief.html">EHL</a> board.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This board configuration works on the variant of <a class="reference external" href="https://www.intel.com/content/www/us/en/products/docs/processors/embedded/enhanced-for-iot-platform-brief.html">EHL</a>
boards containing Intel® Atom™ SoC.</p>
</div>
</div>
<div class="section" id="hardware">
<h2>Hardware<a class="headerlink" href="#hardware" title="Permalink to this headline">¶</a></h2>
<p>General information about the board can be found at the <a class="reference external" href="https://www.intel.com/content/www/us/en/products/docs/processors/embedded/enhanced-for-iot-platform-brief.html">EHL</a> website.</p>
<div class="section" id="supported-features">
<h3>Supported Features<a class="headerlink" href="#supported-features" title="Permalink to this headline">¶</a></h3>
<p>In addition to the standard architecture devices (HPET, local and I/O APICs,
etc.), Zephyr supports the following Elkhart Lake-specific SoC devices:</p>
<ul class="simple">
<li><p>I2C</p></li>
</ul>
<div class="section" id="uart-serial-port-support">
<h4>UART Serial Port Support<a class="headerlink" href="#uart-serial-port-support" title="Permalink to this headline">¶</a></h4>
<p>The Elkhart Lake UARTs are NS16550-compatible. Baud rate of
115.2kbps is supported.</p>
</div>
</div>
<div class="section" id="connections-and-ios">
<h3>Connections and IOs<a class="headerlink" href="#connections-and-ios" title="Permalink to this headline">¶</a></h3>
<p>Refer to the <a class="reference external" href="https://www.intel.com/content/www/us/en/products/docs/processors/embedded/enhanced-for-iot-platform-brief.html">EHL</a> website for more information.</p>
</div>
</div>
<div class="section" id="programming-and-debugging">
<h2>Programming and Debugging<a class="headerlink" href="#programming-and-debugging" title="Permalink to this headline">¶</a></h2>
<p>Use the following procedures for booting an image on a EHL CRB board.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#build-zephyr-application" id="id1">Build Zephyr application</a></p></li>
<li><p><a class="reference internal" href="#preparing-the-boot-device" id="id2">Preparing the Boot Device</a></p></li>
<li><p><a class="reference internal" href="#booting-the-elkhart-lake-crb-board" id="id3">Booting the Elkhart Lake CRB Board</a></p></li>
<li><p><a class="reference internal" href="#booting-the-elkhart-lake-crb-board-over-network" id="id4">Booting the Elkhart Lake CRB Board over network</a></p></li>
</ul>
</div>
<div class="section" id="build-zephyr-application">
<h3><a class="toc-backref" href="#contents">Build Zephyr application</a><a class="headerlink" href="#build-zephyr-application" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Build a Zephyr application; for instance, to build the <code class="docutils literal notranslate"><span class="pre">hello_world</span></code>
application on Elkhart Lake CRB:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>From the root of the zephyr repository
<span class="go">west build -b ehl_crb samples/hello_world</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Zephyr EFI image file named <code class="file docutils literal notranslate"><span class="pre">zephyr.efi</span></code> is automatically
created in the build directory after the application is built.</p>
</div>
</li>
</ol>
</div>
<div class="section" id="preparing-the-boot-device">
<h3><a class="toc-backref" href="#contents">Preparing the Boot Device</a><a class="headerlink" href="#preparing-the-boot-device" title="Permalink to this headline">¶</a></h3>
<p>Prepare a USB flash drive to boot the Zephyr application image on
an Elkhart Lake CRB board.</p>
<ol class="arabic">
<li><p>Format the USB flash drive as FAT32.</p>
<p>On Windows, open <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">Explorer</span></code>, and right-click on the USB flash drive.
Select <code class="docutils literal notranslate"><span class="pre">Format...</span></code>. Make sure in <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">System</span></code>, <code class="docutils literal notranslate"><span class="pre">FAT32</span></code> is selected.
Click on the <code class="docutils literal notranslate"><span class="pre">Format</span></code> button and wait for it to finish.</p>
<p>On Linux, graphical utilities such as <code class="docutils literal notranslate"><span class="pre">gparted</span></code> can be used to format
the USB flash drive as FAT32. Alternatively, under terminal, find out
the corresponding device node for the USB flash drive (for example,
<code class="docutils literal notranslate"><span class="pre">/dev/sdd</span></code>). Execute the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkfs.vfat -F <span class="m">32</span> &lt;device-node&gt;
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Make sure the device node is the actual device node for
the USB flash drive. Or else you may erase other storage devices
on your system, and will render the system unusable afterwards.</p>
</div>
</li>
<li><p>Copy the Zephyr EFI image file <code class="file docutils literal notranslate"><span class="pre">zephyr/zephyr.efi</span></code> to the USB drive.</p></li>
</ol>
</div>
<div class="section" id="booting-the-elkhart-lake-crb-board">
<h3><a class="toc-backref" href="#contents">Booting the Elkhart Lake CRB Board</a><a class="headerlink" href="#booting-the-elkhart-lake-crb-board" title="Permalink to this headline">¶</a></h3>
<p>Boot the Elkhart Lake CRB board to the EFI shell with USB flash drive connected.</p>
<ol class="arabic">
<li><p>Insert the prepared boot device (USB flash drive) into the Elkhart Lake CRB board.</p></li>
<li><p>Connect the board to the host system using the serial cable and
configure your host system to watch for serial data.  See
<a class="reference external" href="https://www.intel.com/content/www/us/en/products/docs/processors/embedded/enhanced-for-iot-platform-brief.html">EHL</a> website for more information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On Windows, PuTTY has an option to set up configuration for
serial data.  Use a baud rate of 115200.</p>
</div>
</li>
<li><p>Power on the Elkhart Lake CRB board.</p></li>
<li><p>When the following output appears, press <kbd class="kbd docutils literal notranslate">F7</kbd>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Press &lt;DEL&gt; or &lt;ESC&gt; to enter setup.</span>
</pre></div>
</div>
</li>
<li><p>From the menu that appears, select the menu entry that describes
that particular EFI shell.</p></li>
<li><p>From the EFI shell select Zephyr EFI image to boot.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Shell&gt; fs0:zephyr.efi</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="booting-the-elkhart-lake-crb-board-over-network">
<h3><a class="toc-backref" href="#contents">Booting the Elkhart Lake CRB Board over network</a><a class="headerlink" href="#booting-the-elkhart-lake-crb-board-over-network" title="Permalink to this headline">¶</a></h3>
<div class="section" id="build-zephyr-image">
<h4>Build Zephyr image<a class="headerlink" href="#build-zephyr-image" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>Follow <a class="reference internal" href="#build-zephyr-application">Build Zephyr application</a> steps to build Zephyr image.</p></li>
</ol>
</div>
<div class="section" id="prepare-linux-host">
<h4>Prepare Linux host<a class="headerlink" href="#prepare-linux-host" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p>Install DHCP, TFTP servers. For example <code class="docutils literal notranslate"><span class="pre">dnsmasq</span></code></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo apt-get install dnsmasq
</pre></div>
</div>
</li>
<li><p>Configure DHCP server. Configuration for <code class="docutils literal notranslate"><span class="pre">dnsmasq</span></code> is below:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>Only listen to this interface
<span class="go">interface=eno2</span>
<span class="go">dhcp-range=10.1.1.20,10.1.1.30,12h</span>
</pre></div>
</div>
</li>
<li><p>Configure TFTP server.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>tftp
<span class="go">enable-tftp</span>
<span class="go">tftp-root=/srv/tftp</span>
<span class="go">dhcp-boot=zephyr.efi</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">zephyr.efi</span></code> is a Zephyr EFI binary created above.</p>
</li>
<li><p>Copy the Zephyr EFI image <code class="file docutils literal notranslate"><span class="pre">zephyr/zephyr.efi</span></code> to the
<code class="file docutils literal notranslate"><span class="pre">/srv/tftp</span></code> folder.</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cp zephyr/zephyr.efi /srv/tftp/
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Restart <code class="docutils literal notranslate"><span class="pre">dnsmasq</span></code> service:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo systemctl restart dnsmasq.service
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="prepare-elkhart-lake-crb-board-for-network-boot">
<h4>Prepare Elkhart Lake CRB board for network boot<a class="headerlink" href="#prepare-elkhart-lake-crb-board-for-network-boot" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p>Enable boot from PXE. Go to EFI shell and make sure that the first boot
option is <code class="docutils literal notranslate"><span class="pre">UEFI</span> <span class="pre">PXEv4</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Shell&gt; bcfg boot dump</span>
<span class="go">Option: 00. Variable: Boot0007</span>
<span class="go">  Desc    - UEFI PXEv4 (MAC:6805CABC1997)</span>
<span class="go">  DevPath - PciRoot(0x0)/Pci(0x1C,0x0)/Pci(0x0,0x0)/MAC(6805CABC1997,0x0)/IPv4(0.0.0.0)</span>
<span class="go">  Optional- Y</span>
<span class="go">...</span>
</pre></div>
</div>
</li>
<li><p>If UEFI PXEv4 is not the first boot option use <code class="docutils literal notranslate"><span class="pre">bcfg</span> <span class="pre">boot</span> <span class="pre">mv</span></code> command to
change boot order</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Shell&gt; bcfg boot mv 7 0</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="booting-elkhart-lake-crb">
<h4>Booting Elkhart Lake CRB<a class="headerlink" href="#booting-elkhart-lake-crb" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p>Connect the board to the host system using the serial cable and
configure your host system to watch for serial data.</p></li>
<li><p>Power on the Elkhart Lake CRB board.</p></li>
<li><p>Verify that the board got an IP address:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>journalctl -f -u dnsmasq
<span class="go">dnsmasq-dhcp[5386]: DHCPDISCOVER(eno2) 00:07:32:52:25:88</span>
<span class="go">dnsmasq-dhcp[5386]: DHCPOFFER(eno2) 10.1.1.28 00:07:32:52:25:88</span>
<span class="go">dnsmasq-dhcp[5386]: DHCPREQUEST(eno2) 10.1.1.28 00:07:32:52:25:88</span>
<span class="go">dnsmasq-dhcp[5386]: DHCPACK(eno2) 10.1.1.28 00:07:32:52:25:88</span>
</pre></div>
</div>
</li>
<li><p>Verify that network booting is started:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>journalctl -f -u dnsmasq
<span class="go">dnsmasq-tftp[5386]: sent /srv/tftp/zephyr.efi to 10.1.1.28</span>
</pre></div>
</div>
</li>
<li><p>When the boot process completes, you have finished booting the
Zephyr application image.</p></li>
</ol>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../qemu_x86/doc/index.html" class="btn btn-neutral float-right" title="X86 Emulation (QEMU)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../acrn/doc/index.html" class="btn btn-neutral" title="Building and Running Zephyr with ACRN" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; <a href="../../../../copyright.html">Copyright</a> 2015-2022 Zephyr Project members and individual contributors.
      Last updated on May 10, 2022.

    </p>
</td>
<td id="zcanlogo">
  <a href="https://www.unisim-micro.com/"><img src="../../../../_static/images/zcan.svg" border="0" style="position:static"/></a>
</td>
</tr>
</table>
  </div> 


</footer>
        </div>
      </div>

    </section>

  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
       <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <div class="rst-other-version zcansdk">
        <a href="../../../../../zcansdk/index.html">ZCAN IOT SDK</a>
      </div>
      
      <div class="rst-other-version zcanxlib">
        <a href="../../../../../zcanxlib/README.html">ZCAN Xlib</a>
      </div>
      
      <div class="rst-other-version mcuboot">
        <a href="../../../../../mcuboot/wrapper.html">MCUboot</a>
      </div>
      
      <div class="rst-other-version sof">
        <a href="../../../../../sof/index.html">SOF</a>
      </div>
      
      <div class="rst-other-version kconfig">
        <a href="../../../../../kconfig/index.html">Kconfig Reference</a>
      </div>
    </div>
  </div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>